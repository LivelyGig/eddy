package io.omoikane.eddy.hash

import org.scalatest._

class Sha512Test extends FreeSpec with Matchers {
  "Empty Hash" in {
    Sha512.hashBytes(Array.empty[Byte]) should be(
      Array(-49, -125, -31, 53, 126, -17, -72, -67, -15, 84, 40, 80, -42, 109, -128, 7, -42, 32, -28, 5, 11, 87, 21, -36, -125, -12, -87,
        33, -45, 108, -23, -50, 71, -48, -47, 60, 93, -123, -14, -80, -1, -125, 24, -46, -121, 126, -20, 47, 99, -71, 49, -67, 71, 65, 122,
        -127, -91, 56, 50, 122, -7, 39, -38, 62).map(_.toByte))
  }

  """Hash "hello"""" in {
    Sha512.hashString("hello") should be(
      Array(-101, 113, -46, 36, -67, 98, -13, 120, 93, -106, -44, 106, -45, -22, 61, 115, 49, -101, -5, -62, -119, 12, -86, -38, -30, -33,
        -9, 37, 25, 103, 60, -89, 35, 35, -61, -39, -101, -91, -63, 29, 124, 122, -52, 110, 20, -72, -59, -38, 12, 70, 99, 71, 92, 46, 92,
        58, -34, -12, 111, 115, -68, -34, -64, 67).map(_.toByte))
  }

  """Hash "هم خدا را خواستن و هم خرما را‎‎"""" in {
    Sha512.hashString("هم خدا را خواستن و هم خرما را‎‎") should be(
      Array(-52, -94, 89, -99, 0, 23, -118, -38, 52, 59, 44, 1, 1, 96, -112, -58, -67, -67, -17, 0, -22, 95, -46, -68, -12, 14, 14, -45,
        -116, -80, -67, 114, 38, -58, 10, -7, 100, 56, 100, -92, 18, -43, 48, -73, -105, 14, -4, -52, 58, -93, 79, 93, 24, 91, -38, 2, -22,
        -57, -33, -85, -68, 86, -28, -15).map(_.toByte))
  }
}
